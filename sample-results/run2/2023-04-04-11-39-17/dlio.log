[INFO] 2023-04-04T11:39:18.299129 Running DLIO with 4 process(es) [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:104]
[INFO] 2023-04-04T11:39:18.299287 Reading workload YAML config file '/home/ubuntu/storage/storage-conf/workload/unet3d.yaml' [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:106]
[INFO] 2023-04-04T11:39:18.366191 Max steps per epoch: 3 = 1 * 50 / 4 / 4 (samples per file * num files / batch size / comm size) [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:274]
[INFO] 2023-04-04T11:39:18.366308 Starting epoch 1: 3 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:39:18.366496 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:39:18.366780 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:39:22.365536 Rank 0 step 1 processed 4 samples in 3.998654365539551 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:22.365542 Rank 1 step 1 processed 4 samples in 3.999058723449707 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:22.365544 Rank 3 step 1 processed 4 samples in 3.999068260192871 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:22.365562 Rank 2 step 1 processed 4 samples in 3.9990735054016113 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:23.729717 Rank 1 step 2 processed 4 samples in 1.363762617111206 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:23.729719 Rank 0 step 2 processed 4 samples in 1.3637824058532715 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:23.729717 Rank 3 step 2 processed 4 samples in 1.3637595176696777 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:23.729718 Rank 2 step 2 processed 4 samples in 1.3637440204620361 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:25.092386 Rank 1 step 3 processed 4 samples in 1.3624391555786133 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:25.092389 Rank 3 step 3 processed 4 samples in 1.3624324798583984 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:25.092389 Rank 2 step 3 processed 4 samples in 1.3624260425567627 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:25.092390 Rank 0 step 3 processed 4 samples in 1.362436294555664 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:25.092629 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:39:25.093015 Ending block 1 - 3 steps completed in 6.73 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:39:25.095821 Epoch 1 - Block 1 [Training] Accelerator Utilization (%): 99.7616 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:39:25.095922 Epoch 1 - Block 1 [Training] Throughput (samples/second): 7.1365 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:39:25.117662 Ending epoch 1 - 3 steps completed in 6.75 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:39:25.123784 Starting epoch 2: 3 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:39:25.123989 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:39:25.124168 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:39:28.527260 Rank 0 step 1 processed 4 samples in 3.4030022621154785 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:28.527272 Rank 1 step 1 processed 4 samples in 3.403244733810425 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:28.527287 Rank 2 step 1 processed 4 samples in 3.403146982192993 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:28.527288 Rank 3 step 1 processed 4 samples in 3.4032342433929443 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:29.891550 Rank 2 step 2 processed 4 samples in 1.3637290000915527 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:29.891549 Rank 0 step 2 processed 4 samples in 1.363893985748291 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:29.891548 Rank 1 step 2 processed 4 samples in 1.3638904094696045 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:29.891551 Rank 3 step 2 processed 4 samples in 1.3638672828674316 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:31.255431 Rank 2 step 3 processed 4 samples in 1.36354398727417 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:31.255432 Rank 3 step 3 processed 4 samples in 1.3636350631713867 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:31.255431 Rank 1 step 3 processed 4 samples in 1.3636524677276611 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:31.255436 Rank 0 step 3 processed 4 samples in 1.3636584281921387 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:31.255821 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:39:31.256173 Ending block 1 - 3 steps completed in 6.13 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:39:31.259490 Epoch 2 - Block 1 [Training] Accelerator Utilization (%): 99.7062 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:39:31.259553 Epoch 2 - Block 1 [Training] Throughput (samples/second): 7.8281 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:39:31.277227 Ending epoch 2 - 3 steps completed in 6.15 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:39:31.290849 Starting epoch 3: 3 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:39:31.291018 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:39:31.291158 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:39:34.702845 Rank 1 step 1 processed 4 samples in 3.403810739517212 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:34.702869 Rank 3 step 1 processed 4 samples in 3.411724090576172 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:34.702866 Rank 2 step 1 processed 4 samples in 3.41166353225708 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:34.702858 Rank 0 step 1 processed 4 samples in 3.4116311073303223 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:36.068157 Rank 3 step 2 processed 4 samples in 1.3649413585662842 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:36.068157 Rank 1 step 2 processed 4 samples in 1.3647739887237549 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:36.068158 Rank 2 step 2 processed 4 samples in 1.3649280071258545 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:36.068157 Rank 0 step 2 processed 4 samples in 1.3649210929870605 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:37.432064 Rank 0 step 3 processed 4 samples in 1.3636384010314941 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:37.432069 Rank 2 step 3 processed 4 samples in 1.3636550903320312 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:37.432068 Rank 1 step 3 processed 4 samples in 1.3636775016784668 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:37.432069 Rank 3 step 3 processed 4 samples in 1.3634779453277588 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:37.432342 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:39:37.432591 Ending block 1 - 3 steps completed in 6.14 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:39:37.440600 Epoch 3 - Block 1 [Training] Accelerator Utilization (%): 99.6755 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:39:37.440731 Epoch 3 - Block 1 [Training] Throughput (samples/second): 7.8160 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:39:37.453591 Ending epoch 3 - 3 steps completed in 6.16 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:39:37.455343 Starting epoch 4: 3 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:39:37.455487 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:39:37.455616 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:39:40.732735 Rank 1 step 1 processed 4 samples in 3.2771551609039307 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:40.732758 Rank 3 step 1 processed 4 samples in 3.277147054672241 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:40.732725 Rank 0 step 1 processed 4 samples in 3.277040958404541 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:40.732749 Rank 2 step 1 processed 4 samples in 3.277158260345459 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:42.097714 Rank 1 step 2 processed 4 samples in 1.3645658493041992 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:42.097715 Rank 3 step 2 processed 4 samples in 1.3645274639129639 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:42.097713 Rank 0 step 2 processed 4 samples in 1.3645460605621338 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:42.097716 Rank 2 step 2 processed 4 samples in 1.3645353317260742 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:43.461503 Rank 3 step 3 processed 4 samples in 1.3635716438293457 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:43.461503 Rank 2 step 3 processed 4 samples in 1.3635468482971191 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:43.461503 Rank 1 step 3 processed 4 samples in 1.3635225296020508 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:43.461503 Rank 0 step 3 processed 4 samples in 1.3635554313659668 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:43.461749 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:39:43.462019 Ending block 1 - 3 steps completed in 6.01 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:39:43.478798 Epoch 4 - Block 1 [Training] Accelerator Utilization (%): 99.6916 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:39:43.480120 Epoch 4 - Block 1 [Training] Throughput (samples/second): 7.9917 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:39:43.494958 Ending epoch 4 - 3 steps completed in 6.04 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:39:43.495471 Starting epoch 5: 3 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:39:43.495620 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:39:43.495787 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:39:46.991176 Rank 3 step 1 processed 4 samples in 3.4954702854156494 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:46.991155 Rank 2 step 1 processed 4 samples in 3.495455265045166 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:46.991155 Rank 0 step 1 processed 4 samples in 3.4952902793884277 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:46.991167 Rank 1 step 1 processed 4 samples in 3.495422840118408 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:48.356801 Rank 3 step 2 processed 4 samples in 1.365225076675415 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:48.356800 Rank 2 step 2 processed 4 samples in 1.365257740020752 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:48.356801 Rank 0 step 2 processed 4 samples in 1.3652567863464355 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:48.356804 Rank 1 step 2 processed 4 samples in 1.3652405738830566 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:49.720765 Rank 3 step 3 processed 4 samples in 1.3636953830718994 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:49.720765 Rank 2 step 3 processed 4 samples in 1.3637337684631348 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:49.720765 Rank 0 step 3 processed 4 samples in 1.363724946975708 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:49.720765 Rank 1 step 3 processed 4 samples in 1.3637115955352783 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:39:49.720972 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:39:49.721210 Ending block 1 - 3 steps completed in 6.23 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:39:49.722442 Epoch 5 - Block 1 [Training] Accelerator Utilization (%): 99.6628 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:39:49.722509 Epoch 5 - Block 1 [Training] Throughput (samples/second): 7.7105 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:39:49.737909 Starting checkpoint 1 after total step 3 for epoch 5 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:209]
[INFO] 2023-04-04T11:39:52.055330 Ending checkpoint 1 for epoch 5 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:219]
[INFO] 2023-04-04T11:39:52.056517 Ending epoch 5 - 3 steps completed in 8.56 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:39:52.057620 Saved outputs in /home/ubuntu/storage/results/unet3d/2023-04-04-11-39-17 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:98]
[INFO] Averaged metric over all epochs
[METRIC] ==========================================================
[METRIC] Training Accelerator Utilization (%): 99.5667 (0.2959)
[METRIC] Training Throughput (samples/second): 7.6924 (0.2943)
[METRIC] Training I/O Throughput (MB/second): 1720.7557 (65.8384)
[METRIC] ==========================================================
 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:109]

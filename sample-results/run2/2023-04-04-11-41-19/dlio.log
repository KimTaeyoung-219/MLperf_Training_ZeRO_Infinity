[INFO] 2023-04-04T11:41:20.375415 Running DLIO with 3 process(es) [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:104]
[INFO] 2023-04-04T11:41:20.375562 Reading workload YAML config file '/home/ubuntu/storage/storage-conf/workload/unet3d.yaml' [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:106]
[INFO] 2023-04-04T11:41:20.438967 Max steps per epoch: 4 = 1 * 50 / 4 / 3 (samples per file * num files / batch size / comm size) [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:274]
[INFO] 2023-04-04T11:41:20.439081 Starting epoch 1: 4 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:41:20.439214 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:41:20.439417 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:41:23.873916 Rank 2 step 1 processed 4 samples in 3.434628963470459 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:23.873916 Rank 1 step 1 processed 4 samples in 3.4346349239349365 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:23.873890 Rank 0 step 1 processed 4 samples in 3.434396743774414 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:25.239033 Rank 1 step 2 processed 4 samples in 1.364684820175171 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:25.239032 Rank 2 step 2 processed 4 samples in 1.3646926879882812 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:25.239034 Rank 0 step 2 processed 4 samples in 1.3646631240844727 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:26.603128 Rank 1 step 3 processed 4 samples in 1.3638854026794434 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:26.603128 Rank 0 step 3 processed 4 samples in 1.363872766494751 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:26.603128 Rank 2 step 3 processed 4 samples in 1.3638803958892822 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:27.966871 Rank 0 step 4 processed 4 samples in 1.363527774810791 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:27.966872 Rank 2 step 4 processed 4 samples in 1.3635222911834717 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:27.966871 Rank 1 step 4 processed 4 samples in 1.3635318279266357 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:27.967076 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:41:27.967361 Ending block 1 - 4 steps completed in 7.53 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:41:27.978851 Epoch 1 - Block 1 [Training] Accelerator Utilization (%): 99.7023 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:41:27.978935 Epoch 1 - Block 1 [Training] Throughput (samples/second): 6.3764 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:41:28.001335 Ending epoch 1 - 4 steps completed in 7.56 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:41:28.001861 Starting epoch 2: 4 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:41:28.001988 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:41:28.002131 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:41:31.276463 Rank 1 step 1 processed 4 samples in 3.274291515350342 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:31.276460 Rank 2 step 1 processed 4 samples in 3.2743523120880127 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:31.276467 Rank 0 step 1 processed 4 samples in 3.274257183074951 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:32.640494 Rank 1 step 2 processed 4 samples in 1.3636884689331055 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:32.640495 Rank 2 step 2 processed 4 samples in 1.363685131072998 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:32.640495 Rank 0 step 2 processed 4 samples in 1.3636255264282227 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:34.005496 Rank 1 step 3 processed 4 samples in 1.364778995513916 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:34.005496 Rank 2 step 3 processed 4 samples in 1.3647739887237549 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:34.005496 Rank 0 step 3 processed 4 samples in 1.3646883964538574 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:35.369393 Rank 0 step 4 processed 4 samples in 1.3636555671691895 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:35.369393 Rank 2 step 4 processed 4 samples in 1.3636677265167236 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:35.369392 Rank 1 step 4 processed 4 samples in 1.3635778427124023 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:35.369641 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:41:35.369917 Ending block 1 - 4 steps completed in 7.37 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:41:35.380688 Epoch 2 - Block 1 [Training] Accelerator Utilization (%): 99.7028 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:41:35.380841 Epoch 2 - Block 1 [Training] Throughput (samples/second): 6.5150 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:41:35.395524 Ending epoch 2 - 4 steps completed in 7.39 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:41:35.396099 Starting epoch 3: 4 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:41:35.396309 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:41:35.396487 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:41:38.992765 Rank 1 step 1 processed 4 samples in 3.5964291095733643 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:38.992808 Rank 2 step 1 processed 4 samples in 3.596457004547119 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:38.992765 Rank 0 step 1 processed 4 samples in 3.5961859226226807 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:40.356750 Rank 2 step 2 processed 4 samples in 1.3636150360107422 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:40.356749 Rank 1 step 2 processed 4 samples in 1.3635752201080322 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:40.356749 Rank 0 step 2 processed 4 samples in 1.3636138439178467 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:41.720523 Rank 0 step 3 processed 4 samples in 1.3635480403900146 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:41.720523 Rank 2 step 3 processed 4 samples in 1.363497018814087 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:41.720523 Rank 1 step 3 processed 4 samples in 1.363553524017334 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:43.085513 Rank 2 step 4 processed 4 samples in 1.3647398948669434 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:43.085513 Rank 0 step 4 processed 4 samples in 1.364677906036377 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:43.085514 Rank 1 step 4 processed 4 samples in 1.364725112915039 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:43.085732 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:41:43.085963 Ending block 1 - 4 steps completed in 7.69 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:41:43.087240 Epoch 3 - Block 1 [Training] Accelerator Utilization (%): 99.7073 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:41:43.087324 Epoch 3 - Block 1 [Training] Throughput (samples/second): 6.2424 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:41:43.102933 Ending epoch 3 - 4 steps completed in 7.71 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:41:43.103518 Starting epoch 4: 4 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:41:43.103670 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:41:43.103820 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:41:46.919067 Rank 1 step 1 processed 4 samples in 3.8153135776519775 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:46.919070 Rank 0 step 1 processed 4 samples in 3.815168857574463 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:46.919065 Rank 2 step 1 processed 4 samples in 3.815300226211548 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:48.282866 Rank 1 step 2 processed 4 samples in 1.363400936126709 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:48.282867 Rank 2 step 2 processed 4 samples in 1.3634309768676758 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:48.282866 Rank 0 step 2 processed 4 samples in 1.363447904586792 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:49.647550 Rank 1 step 3 processed 4 samples in 1.3643922805786133 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:49.647550 Rank 0 step 3 processed 4 samples in 1.3644392490386963 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:49.647550 Rank 2 step 3 processed 4 samples in 1.3644464015960693 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:51.011171 Rank 2 step 4 processed 4 samples in 1.3633904457092285 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:51.011163 Rank 1 step 4 processed 4 samples in 1.363326072692871 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:51.011161 Rank 0 step 4 processed 4 samples in 1.3633837699890137 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:51.011386 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:41:51.011617 Ending block 1 - 4 steps completed in 7.91 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:41:51.012638 Epoch 4 - Block 1 [Training] Accelerator Utilization (%): 99.7237 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:41:51.012697 Epoch 4 - Block 1 [Training] Throughput (samples/second): 6.0701 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:41:51.028235 Ending epoch 4 - 4 steps completed in 7.92 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:41:51.031200 Starting epoch 5: 4 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:41:51.031392 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:41:51.031557 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:41:54.694849 Rank 2 step 1 processed 4 samples in 3.6634202003479004 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:54.694834 Rank 1 step 1 processed 4 samples in 3.6633996963500977 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:54.694849 Rank 0 step 1 processed 4 samples in 3.6632001399993896 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:56.058679 Rank 0 step 2 processed 4 samples in 1.363466739654541 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:56.058679 Rank 1 step 2 processed 4 samples in 1.363471508026123 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:56.058679 Rank 2 step 2 processed 4 samples in 1.3634397983551025 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:57.423303 Rank 2 step 3 processed 4 samples in 1.364363193511963 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:57.423303 Rank 1 step 3 processed 4 samples in 1.364363193511963 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:57.423303 Rank 0 step 3 processed 4 samples in 1.3642735481262207 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:58.785968 Rank 1 step 4 processed 4 samples in 1.3624382019042969 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:58.785968 Rank 2 step 4 processed 4 samples in 1.36238431930542 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:58.785968 Rank 0 step 4 processed 4 samples in 1.3624320030212402 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:41:58.786265 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:41:58.787281 Ending block 1 - 4 steps completed in 7.76 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:41:58.788678 Epoch 5 - Block 1 [Training] Accelerator Utilization (%): 99.7424 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:41:58.788758 Epoch 5 - Block 1 [Training] Throughput (samples/second): 6.1896 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:41:58.806347 Starting checkpoint 1 after total step 4 for epoch 5 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:209]
[INFO] 2023-04-04T11:42:01.219375 Ending checkpoint 1 for epoch 5 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:219]
[INFO] 2023-04-04T11:42:01.220378 Ending epoch 5 - 4 steps completed in 10.19 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:42:01.221367 Saved outputs in /home/ubuntu/storage/results/unet3d/2023-04-04-11-41-19 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:98]
[INFO] Averaged metric over all epochs
[METRIC] ==========================================================
[METRIC] Training Accelerator Utilization (%): 99.6372 (0.1482)
[METRIC] Training Throughput (samples/second): 6.2761 (0.1554)
[METRIC] Training I/O Throughput (MB/second): 1403.9216 (34.7527)
[METRIC] ==========================================================
 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:109]

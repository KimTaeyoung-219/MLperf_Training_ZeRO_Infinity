[INFO] 2023-04-04T11:36:33.452672 Running DLIO with 3 process(es) [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:104]
[INFO] 2023-04-04T11:36:33.452815 Reading workload YAML config file '/home/ubuntu/storage/storage-conf/workload/unet3d.yaml' [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:106]
[INFO] 2023-04-04T11:36:33.514906 Max steps per epoch: 4 = 1 * 50 / 4 / 3 (samples per file * num files / batch size / comm size) [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:274]
[INFO] 2023-04-04T11:36:33.515027 Starting epoch 1: 4 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:36:33.515149 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:36:33.515358 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:36:37.399395 Rank 0 step 1 processed 4 samples in 3.88396954536438 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:37.399414 Rank 1 step 1 processed 4 samples in 3.8840842247009277 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:37.399416 Rank 2 step 1 processed 4 samples in 3.8842074871063232 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:38.764123 Rank 2 step 2 processed 4 samples in 1.3642163276672363 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:38.764124 Rank 0 step 2 processed 4 samples in 1.3643443584442139 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:38.764123 Rank 1 step 2 processed 4 samples in 1.364333152770996 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:40.126806 Rank 0 step 3 processed 4 samples in 1.3624422550201416 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:40.126815 Rank 2 step 3 processed 4 samples in 1.3623697757720947 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:40.126805 Rank 1 step 3 processed 4 samples in 1.3624293804168701 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:41.489510 Rank 1 step 4 processed 4 samples in 1.3624632358551025 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:41.489511 Rank 2 step 4 processed 4 samples in 1.3623502254486084 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:41.489512 Rank 0 step 4 processed 4 samples in 1.3624725341796875 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:41.489756 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:36:41.490135 Ending block 1 - 4 steps completed in 7.97 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:36:41.492972 Epoch 1 - Block 1 [Training] Accelerator Utilization (%): 99.7717 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:36:41.493069 Epoch 1 - Block 1 [Training] Throughput (samples/second): 6.0192 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:36:41.513332 Ending epoch 1 - 4 steps completed in 8.00 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:36:41.513914 Starting epoch 2: 4 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:36:41.514050 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:36:41.514200 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:36:45.055980 Rank 1 step 1 processed 4 samples in 3.541837692260742 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:45.055997 Rank 2 step 1 processed 4 samples in 3.5417699813842773 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:45.055994 Rank 0 step 1 processed 4 samples in 3.5417120456695557 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:46.418875 Rank 0 step 2 processed 4 samples in 1.3625156879425049 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:46.418892 Rank 2 step 2 processed 4 samples in 1.3625450134277344 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:46.418884 Rank 1 step 2 processed 4 samples in 1.3625457286834717 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:47.782634 Rank 1 step 3 processed 4 samples in 1.3635082244873047 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:47.782634 Rank 0 step 3 processed 4 samples in 1.3635342121124268 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:47.782636 Rank 2 step 3 processed 4 samples in 1.3635244369506836 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:49.146484 Rank 0 step 4 processed 4 samples in 1.3636105060577393 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:49.146484 Rank 1 step 4 processed 4 samples in 1.3636183738708496 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:49.146487 Rank 2 step 4 processed 4 samples in 1.363600492477417 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:49.146752 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:36:49.146978 Ending block 1 - 4 steps completed in 7.63 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:36:49.148108 Epoch 2 - Block 1 [Training] Accelerator Utilization (%): 99.7618 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:36:49.148175 Epoch 2 - Block 1 [Training] Throughput (samples/second): 6.2888 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:36:49.167688 Ending epoch 2 - 4 steps completed in 7.65 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:36:49.168468 Starting epoch 3: 4 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:36:49.168619 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:36:49.168765 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:36:52.475609 Rank 1 step 1 processed 4 samples in 3.30686616897583 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:52.475617 Rank 2 step 1 processed 4 samples in 3.3069040775299072 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:52.475597 Rank 0 step 1 processed 4 samples in 3.3067586421966553 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:53.842426 Rank 0 step 2 processed 4 samples in 1.3663921356201172 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:53.842434 Rank 2 step 2 processed 4 samples in 1.3664746284484863 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:53.842428 Rank 1 step 2 processed 4 samples in 1.3663983345031738 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:55.205196 Rank 2 step 3 processed 4 samples in 1.3625354766845703 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:55.205196 Rank 0 step 3 processed 4 samples in 1.3624382019042969 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:55.205196 Rank 1 step 3 processed 4 samples in 1.362497329711914 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:56.568900 Rank 2 step 4 processed 4 samples in 1.3634147644042969 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:56.568900 Rank 0 step 4 processed 4 samples in 1.3634634017944336 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:56.568900 Rank 1 step 4 processed 4 samples in 1.3634576797485352 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:56.569129 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:36:56.569421 Ending block 1 - 4 steps completed in 7.40 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:36:56.570628 Epoch 3 - Block 1 [Training] Accelerator Utilization (%): 99.6924 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:36:56.570711 Epoch 3 - Block 1 [Training] Throughput (samples/second): 6.4860 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:36:56.584107 Ending epoch 3 - 4 steps completed in 7.42 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:36:56.586665 Starting epoch 4: 4 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:36:56.586912 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:36:56.587092 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:37:00.275423 Rank 1 step 1 processed 4 samples in 3.688511610031128 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:00.275438 Rank 2 step 1 processed 4 samples in 3.6885201930999756 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:00.275426 Rank 0 step 1 processed 4 samples in 3.6882505416870117 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:01.641617 Rank 1 step 2 processed 4 samples in 1.3658607006072998 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:01.641622 Rank 0 step 2 processed 4 samples in 1.3658299446105957 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:01.641620 Rank 2 step 2 processed 4 samples in 1.3658318519592285 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:03.004606 Rank 2 step 3 processed 4 samples in 1.3626890182495117 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:03.004607 Rank 0 step 3 processed 4 samples in 1.3625884056091309 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:03.004607 Rank 1 step 3 processed 4 samples in 1.3626718521118164 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:04.368570 Rank 2 step 4 processed 4 samples in 1.3636164665222168 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:04.368570 Rank 1 step 4 processed 4 samples in 1.3636696338653564 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:04.368570 Rank 0 step 4 processed 4 samples in 1.3636853694915771 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:04.368811 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:37:04.369129 Ending block 1 - 4 steps completed in 7.78 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:37:04.374403 Epoch 4 - Block 1 [Training] Accelerator Utilization (%): 99.6952 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:37:04.374498 Epoch 4 - Block 1 [Training] Throughput (samples/second): 6.1682 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:37:04.392460 Ending epoch 4 - 4 steps completed in 7.81 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:37:04.393059 Starting epoch 5: 4 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:37:04.393212 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:37:04.393372 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:37:07.863792 Rank 2 step 1 processed 4 samples in 3.470503568649292 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:07.863801 Rank 1 step 1 processed 4 samples in 3.4705185890197754 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:07.863801 Rank 0 step 1 processed 4 samples in 3.470353126525879 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:09.227587 Rank 2 step 2 processed 4 samples in 1.3634536266326904 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:09.227587 Rank 0 step 2 processed 4 samples in 1.3634438514709473 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:09.227587 Rank 1 step 2 processed 4 samples in 1.3634490966796875 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:10.591398 Rank 2 step 3 processed 4 samples in 1.363586664199829 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:10.591398 Rank 0 step 3 processed 4 samples in 1.3635797500610352 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:10.591398 Rank 1 step 3 processed 4 samples in 1.363574743270874 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:11.955451 Rank 2 step 4 processed 4 samples in 1.3637678623199463 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:11.955451 Rank 0 step 4 processed 4 samples in 1.363821029663086 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:11.955451 Rank 1 step 4 processed 4 samples in 1.363811731338501 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:37:11.955683 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:37:11.955924 Ending block 1 - 4 steps completed in 7.56 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:37:11.957601 Epoch 5 - Block 1 [Training] Accelerator Utilization (%): 99.7341 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:37:11.957667 Epoch 5 - Block 1 [Training] Throughput (samples/second): 6.3472 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:37:11.969838 Starting checkpoint 1 after total step 4 for epoch 5 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:209]
[INFO] 2023-04-04T11:37:13.911745 Ending checkpoint 1 for epoch 5 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:219]
[INFO] 2023-04-04T11:37:13.912822 Ending epoch 5 - 4 steps completed in 9.52 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:37:13.913819 Saved outputs in /home/ubuntu/storage/results/unet3d/2023-04-04-11-36-32 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:98]
[INFO] Averaged metric over all epochs
[METRIC] ==========================================================
[METRIC] Training Accelerator Utilization (%): 99.6730 (0.1242)
[METRIC] Training Throughput (samples/second): 6.2598 (0.1577)
[METRIC] Training I/O Throughput (MB/second): 1400.2838 (35.2682)
[METRIC] ==========================================================
 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:109]

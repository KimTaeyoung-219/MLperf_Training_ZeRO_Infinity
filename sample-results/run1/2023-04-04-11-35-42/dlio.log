[INFO] 2023-04-04T11:35:43.050622 Running DLIO with 4 process(es) [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:104]
[INFO] 2023-04-04T11:35:43.050799 Reading workload YAML config file '/home/ubuntu/storage/storage-conf/workload/unet3d.yaml' [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:106]
[INFO] 2023-04-04T11:35:43.113928 Max steps per epoch: 3 = 1 * 50 / 4 / 4 (samples per file * num files / batch size / comm size) [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:274]
[INFO] 2023-04-04T11:35:43.114042 Starting epoch 1: 3 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:35:43.114164 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:35:43.114360 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:35:46.415727 Rank 0 step 1 processed 4 samples in 3.301297187805176 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:46.415732 Rank 2 step 1 processed 4 samples in 3.3014986515045166 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:46.415724 Rank 3 step 1 processed 4 samples in 3.3015027046203613 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:46.415759 Rank 1 step 1 processed 4 samples in 3.301544666290283 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:47.780686 Rank 1 step 2 processed 4 samples in 1.364488124847412 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:47.780688 Rank 2 step 2 processed 4 samples in 1.3645076751708984 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:47.780688 Rank 3 step 2 processed 4 samples in 1.3645012378692627 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:47.780685 Rank 0 step 2 processed 4 samples in 1.3645844459533691 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:49.144470 Rank 0 step 3 processed 4 samples in 1.3635385036468506 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:49.144472 Rank 1 step 3 processed 4 samples in 1.3635661602020264 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:49.144475 Rank 2 step 3 processed 4 samples in 1.363555669784546 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:49.144475 Rank 3 step 3 processed 4 samples in 1.3635504245758057 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:49.144668 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:35:49.144915 Ending block 1 - 3 steps completed in 6.03 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:35:49.147202 Epoch 1 - Block 1 [Training] Accelerator Utilization (%): 99.6960 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:35:49.147262 Epoch 1 - Block 1 [Training] Throughput (samples/second): 7.9597 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:35:49.171499 Ending epoch 1 - 3 steps completed in 6.06 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:35:49.172020 Starting epoch 2: 3 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:35:49.172139 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:35:49.172276 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:35:52.722843 Rank 1 step 1 processed 4 samples in 3.550499200820923 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:52.722862 Rank 3 step 1 processed 4 samples in 3.55045747756958 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:52.722834 Rank 0 step 1 processed 4 samples in 3.5504775047302246 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:52.722874 Rank 2 step 1 processed 4 samples in 3.5505521297454834 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:54.087929 Rank 1 step 2 processed 4 samples in 1.3646044731140137 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:54.087930 Rank 0 step 2 processed 4 samples in 1.3647079467773438 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:54.087930 Rank 3 step 2 processed 4 samples in 1.3647146224975586 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:54.087932 Rank 2 step 2 processed 4 samples in 1.3646578788757324 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:55.451778 Rank 0 step 3 processed 4 samples in 1.3635995388031006 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:55.451779 Rank 1 step 3 processed 4 samples in 1.3634872436523438 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:55.451778 Rank 3 step 3 processed 4 samples in 1.3635962009429932 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:55.451778 Rank 2 step 3 processed 4 samples in 1.3635728359222412 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:55.452025 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:35:55.452260 Ending block 1 - 3 steps completed in 6.28 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:35:55.454024 Epoch 2 - Block 1 [Training] Accelerator Utilization (%): 99.6859 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:35:55.454090 Epoch 2 - Block 1 [Training] Throughput (samples/second): 7.6435 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:35:55.471139 Ending epoch 2 - 3 steps completed in 6.30 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:35:55.471752 Starting epoch 3: 3 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:35:55.471939 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:35:55.472079 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:35:58.514981 Rank 1 step 1 processed 4 samples in 3.042975425720215 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:58.514971 Rank 2 step 1 processed 4 samples in 3.0429515838623047 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:58.514965 Rank 3 step 1 processed 4 samples in 3.0319535732269287 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:58.514968 Rank 0 step 1 processed 4 samples in 3.042823076248169 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:59.880300 Rank 0 step 2 processed 4 samples in 1.3649330139160156 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:59.880303 Rank 2 step 2 processed 4 samples in 1.3649559020996094 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:59.880303 Rank 1 step 2 processed 4 samples in 1.36488676071167 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:35:59.880307 Rank 3 step 2 processed 4 samples in 1.3649451732635498 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:01.244317 Rank 1 step 3 processed 4 samples in 1.363703727722168 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:01.244316 Rank 2 step 3 processed 4 samples in 1.3637871742248535 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:01.244316 Rank 3 step 3 processed 4 samples in 1.3637464046478271 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:01.244316 Rank 0 step 3 processed 4 samples in 1.3637592792510986 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:01.244568 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:36:01.244936 Ending block 1 - 3 steps completed in 5.77 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:36:01.246738 Epoch 3 - Block 1 [Training] Accelerator Utilization (%): 99.6687 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:36:01.246835 Epoch 3 - Block 1 [Training] Throughput (samples/second): 8.3151 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:36:01.263165 Ending epoch 3 - 3 steps completed in 5.79 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:36:01.270763 Starting epoch 4: 3 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:36:01.270999 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:36:01.271161 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:36:04.786858 Rank 1 step 1 processed 4 samples in 3.515848398208618 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:04.786842 Rank 0 step 1 processed 4 samples in 3.5155951976776123 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:04.787487 Rank 2 step 1 processed 4 samples in 3.516484498977661 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:04.787479 Rank 3 step 1 processed 4 samples in 3.516468048095703 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:06.154807 Rank 2 step 2 processed 4 samples in 1.3669147491455078 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:06.154807 Rank 1 step 2 processed 4 samples in 1.3675215244293213 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:06.154807 Rank 0 step 2 processed 4 samples in 1.3675670623779297 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:06.154807 Rank 3 step 2 processed 4 samples in 1.3669579029083252 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:07.519136 Rank 0 step 3 processed 4 samples in 1.364102840423584 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:07.519135 Rank 2 step 3 processed 4 samples in 1.3639051914215088 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:07.519136 Rank 3 step 3 processed 4 samples in 1.3640985488891602 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:07.519138 Rank 1 step 3 processed 4 samples in 1.3641111850738525 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:07.519411 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:36:07.519660 Ending block 1 - 3 steps completed in 6.25 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:36:07.523700 Epoch 4 - Block 1 [Training] Accelerator Utilization (%): 99.5613 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:36:07.523834 Epoch 4 - Block 1 [Training] Throughput (samples/second): 7.6821 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:36:07.563176 Ending epoch 4 - 3 steps completed in 6.29 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:36:07.563868 Starting epoch 5: 3 steps expected [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:116]
[INFO] 2023-04-04T11:36:07.564071 Prefetch size is 0; a default prefetch factor of 2 will be set to Torch DataLoader. [/home/ubuntu/storage/dlio_benchmark/src/reader/torch_data_loader_reader.py:123]
[INFO] 2023-04-04T11:36:07.564262 Starting block 1 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:182]
[INFO] 2023-04-04T11:36:10.806110 Rank 3 step 1 processed 4 samples in 3.241879940032959 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:10.806128 Rank 2 step 1 processed 4 samples in 3.241959810256958 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:10.806111 Rank 1 step 1 processed 4 samples in 3.241837501525879 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:10.806134 Rank 0 step 1 processed 4 samples in 3.2417731285095215 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:12.171599 Rank 0 step 2 processed 4 samples in 1.3649837970733643 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:12.171602 Rank 1 step 2 processed 4 samples in 1.3650968074798584 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:12.171602 Rank 3 step 2 processed 4 samples in 1.365105152130127 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:12.171602 Rank 2 step 2 processed 4 samples in 1.3651037216186523 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:13.535347 Rank 1 step 3 processed 4 samples in 1.3635125160217285 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:13.535348 Rank 2 step 3 processed 4 samples in 1.36350417137146 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:13.535348 Rank 3 step 3 processed 4 samples in 1.3635098934173584 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:13.535349 Rank 0 step 3 processed 4 samples in 1.3633558750152588 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:243]
[INFO] 2023-04-04T11:36:13.535575 Maximum number of steps reached [/home/ubuntu/storage/dlio_benchmark/src/dlio_benchmark.py:247]
[INFO] 2023-04-04T11:36:13.535870 Ending block 1 - 3 steps completed in 5.97 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:200]
[INFO] 2023-04-04T11:36:13.537631 Epoch 5 - Block 1 [Training] Accelerator Utilization (%): 99.6748 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:203]
[INFO] 2023-04-04T11:36:13.537725 Epoch 5 - Block 1 [Training] Throughput (samples/second): 8.0383 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:204]
[INFO] 2023-04-04T11:36:13.554619 Starting checkpoint 1 after total step 3 for epoch 5 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:209]
[INFO] 2023-04-04T11:36:15.796377 Ending checkpoint 1 for epoch 5 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:219]
[INFO] 2023-04-04T11:36:15.797569 Ending epoch 5 - 3 steps completed in 8.23 s [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:143]
[INFO] 2023-04-04T11:36:15.798664 Saved outputs in /home/ubuntu/storage/results/unet3d/2023-04-04-11-35-42 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:98]
[INFO] Averaged metric over all epochs
[METRIC] ==========================================================
[METRIC] Training Accelerator Utilization (%): 99.5222 (0.2790)
[METRIC] Training Throughput (samples/second): 7.9234 (0.2459)
[METRIC] Training I/O Throughput (MB/second): 1772.4124 (55.0068)
[METRIC] ==========================================================
 [/home/ubuntu/storage/dlio_benchmark/src/utils/statscounter.py:109]
